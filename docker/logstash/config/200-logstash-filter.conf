filter {

    date {
        match => ["time", "UNIX"]
    }

    mutate {
        remove_field => ["_id"]
        lowercase => ["owner_id"]
    }

    if "portals" in [tags] {
        geoip {
            source => "ip"
        }
    }

    if "gocky" in [tags] {
        http {
            url => "${TSFDB_URL}"
            verb => "POST"
            body_format => "json"
            body => { "time" => "%{@timestamp}" "gocky.dp" => "%{counter}, gocky=%{gockyId}, resourceId=%{machine}" "owner" => "%{owner}"}
            headers => { "owner" => "%{owner}" }
        }
    }
}
